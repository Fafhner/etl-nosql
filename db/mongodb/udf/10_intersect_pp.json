{
  "name": "10_intersect_pp",
  "type": "partial-pushdown",
  "datasets": {
    "date_dim": {
      "table_schema": "date_dim",
      "query": "SELECT * FROM tpc_ds.date_dim WHERE d_year=1999 AND d_dom <=4 ALLOW FILTERING;",
      "filter": { "d_year":  { "$eq": 1999 }, "d_dom":  { "$lte": 4} },
      "projection": {"_id":0, "d_date_sk":  1}
    },
    "store_sales": {
      "table_schema": "store_sales",
      "query": "SELECT ss_sold_date_sk, ss_customer_sk, ss_item_sk FROM tpc_ds.store_sales WHERE ss_net_profit>0 ALLOW FILTERING;",
      "filter": { "ss_net_profit": { "$gt":  0}},
      "projection": {"_id":0, "ss_sold_date_sk":  1, "ss_customer_sk":  1, "ss_item_sk":  1}
    },
    "catalog_sales": {
      "table_schema": "catalog_sales",
      "query": "SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk FROM tpc_ds.catalog_sales;",
      "filter": {},
      "projection": {"_id":0, "cs_sold_date_sk":  1, "cs_bill_customer_sk":  1, "cs_item_sk":  1}
    }
  },
  "spark_sql": "SELECT COUNT(*) FROM (\n  SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk\n  FROM catalog_sales\n  JOIN date_dim ON (cs_sold_date_sk=d_date_sk)\n  INTERSECT \n  SELECT ss_sold_date_sk, ss_customer_sk, ss_item_sk\n  FROM store_sales\n  JOIN date_dim ON (ss_sold_date_sk=d_date_sk)\n)"
}