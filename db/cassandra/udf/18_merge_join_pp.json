
{
  "type": "partial-pushdown",
  "datasets": {
    "web_sales": {
      "table_schema": "web_sales",
      "index": "d_date_sk",
      "query": "SELECT * FROM tpc_ds.web_sales;"
    },
    "warehouse": {
      "table_schema": "warehouse",
      "query": "SELECT * FROM tpc_ds.warehouse;"
    },
    "date_dim": {
      "table_schema": "date_dim",
      "query": "SELECT * FROM tpc_ds.date_dim;"
    }
  },
  "steps": [
    {
      "etl_func": "filter",
      "args_tb": {
        "tb": "date_dim"
      },
      "args": {
        "col": "d_year",
        "sign": "=",
        "val": 2000
      },
      "output": "date_dim"
    },
    {
      "etl_func": "inner_join",
      "args_tb": {
        "left_tb": "web_sales",
        "right_tb": "date_dim"
      },
      "args": {
        "left_idx": "ws_sold_date_sk",
        "right_idx": "d_date_sk"
      },
      "output": "WS_DD",
      "remove": [
        "web_sales",
        "date_dim"
      ]
    },
    {
      "etl_func": "inner_join",
      "args_tb": {
        "left_tb": "WS_DD",
        "right_tb": "warehouse"
      },
      "args": {
        "left_idx": "ws_warehouse_sk",
        "right_idx": "w_warehouse_sk"
      },
      "output": "WS_DD_W",
      "remove": [
        "WS_DD",
        "warehouse"
      ]
    },
    {
      "etl_func": "count",
      "args_tb": {
        "tb": "WS_DD_W"
      },
      "output": "SS_CS_DD_count",
      "remove": [
        "SS_CS_DD"
      ]
    }
  ]
}